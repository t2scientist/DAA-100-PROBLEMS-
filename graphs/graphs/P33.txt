#include<bits/stdc++.h>
using namespace std;

const int INF = 1e8;

class Solution {
  public:
    vector<int> bellmanFord(int V, vector<vector<int>>& edges, int src) {

        vector<int> dist(V, INF);
        dist[src] = 0;

        for(int i = 0; i < V - 1; i++){
            for(auto &e : edges){
                int u = e[0], v = e[1], w = e[2];
                if(dist[u] != INF && dist[u] + w < dist[v]){
                    dist[v] = dist[u] + w;
                }
            }
        }

        for(auto &e : edges){
            int u = e[0], v = e[1], w = e[2];
            if(dist[u] != INF && dist[u] + w < dist[v]){
                return {-1};
            }
        }

        return dist;
    }
};

vector<vector<int>> makeWeightedEdges(string s,int v){
    int j=0;
    vector<int> temp;
    string num = "";
    vector<vector<int>> edges;
    for(int i=0;i<s.length();i++){
        if(isdigit(s[i]) || s[i]=='-'){
            num+=s[i];
        }else if(!num.empty()){
            temp.push_back(stoi(num));
            num = "";
            j++;
        }
        if(j==3){
            edges.push_back(temp);
            temp.clear();
            j = 0;
        }
    }
    return edges;
}

void printVec(vector<int> &v) {
    cout << "[";
    for (auto x : v) cout << x << " ";
    cout << "]";
}

int main(){
    Solution S;
    int V,src;
    cin>>V>>src;
    string s;
    cin.ignore();
    getline(cin,s);
    auto edges = makeWeightedEdges(s,V);
    vector<int> dist = S.bellmanFord(V,edges,src);
    printVec(dist);
    return 0;
}
