#include <bits/stdc++.h>
using namespace std;

vector<vector<int>> getRoads(string s, int v) {
    string num = "";
    vector<vector<int>> roads;
    vector<int> temp;
    int j = 0;

    for (char c : s) {
        if (isdigit(c)) {
            num += c;
        } else if (!num.empty()) {
            temp.push_back(stoi(num));
            num = "";
            j++;

            if (j == 3) {
                roads.push_back(temp);
                temp.clear();
                j = 0;
            }
        }
    }

    // In case last number not processed (e.g., no trailing non-digit)
    if (!num.empty()) {
        temp.push_back(stoi(num));
        if (temp.size() == 3) roads.push_back(temp);
    }

    return roads;
}

struct cmp {
    bool operator()(pair<int, long long> a, pair<int, long long> b) {
        return a.second > b.second;
    }
};

class Solution {
public:
    int countPaths(int v, vector<vector<int>>& roads) {
        vector<vector<pair<int, long long>>> graph(v);
        for (int i = 0; i < roads.size(); i++) {
            int v1 = roads[i][0], v2 = roads[i][1], w = roads[i][2];
            graph[v1].push_back({v2, w});
            graph[v2].push_back({v1, w});
        }

        const int MOD = 1e9 + 7;
        priority_queue<pair<int, long long>, vector<pair<int, long long>>, cmp> pq;
        vector<long long> ways(v, 0), dist(v, LLONG_MAX);

        ways[0] = 1;
        dist[0] = 0;
        pq.push({0, 0});

        while (!pq.empty()) {
            auto [V, d] = pq.top();
            pq.pop();

            if (d > dist[V]) continue;

            for (auto [n, wt] : graph[V]) {
                if (dist[V] + wt < dist[n]) {
                    dist[n] = dist[V] + wt;
                    ways[n] = ways[V];
                    pq.push({n, dist[n]});
                } else if (dist[V] + wt == dist[n]) {
                    ways[n] = (ways[n] + ways[V]) % MOD;
                }
            }
        }

        return ways[v - 1] % MOD;
    }
};

int main() {
    Solution S;
    int v;
    cin >> v;
    cin.ignore();
    string s;
    getline(cin, s);

    auto roads = getRoads(s, v);
    int ways = S.countPaths(v, roads);
    cout << ways;
    return 0;
}
